<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medicine Page</title>
<style>
body { font-family: Arial; text-align:center; padding:20px; }
#result { margin-top:20px; font-weight:bold; }
.success { color: green; }
.error { color: red; }
</style>
</head>
<body>
<h1>Medicine Information</h1>
<p>Medicine: Amlodipine 5 mg Tablet</p>
<div id="result"></div>

<script>
const patientId = "P504321"; // معرف المريض الصحيح
const resultDiv = document.getElementById("result");

// التحقق من فتح صفحة المريض أولاً
const scannedId = localStorage.getItem("scannedPatientId");
const scanTime = localStorage.getItem("scanTime"); // وقت فتح صفحة المريض

if (!scannedId || !scanTime) {
    resultDiv.innerHTML = "❌ Please open the patient page first!";
    resultDiv.className = "error";
} else {
    const now = Date.now();
    const elapsedMinutes = (now - parseInt(scanTime, 10)) / 1000 / 60;

    if (elapsedMinutes > 1) { // شرط الدقيقة
        resultDiv.innerHTML = "⌛️ Session expired. Please scan the patient page again!";
        resultDiv.className = "error";
        localStorage.removeItem("scannedPatientId");
        localStorage.removeItem("scanTime");
    } else if (scannedId === patientId) {
        resultDiv.innerHTML = "✅ This medicine belongs to the patient!";
        resultDiv.className = "success";
    } else {
        resultDiv.innerHTML = "❌ Please open the patient page first!";
        resultDiv.className = "error";
    }
}
</script>
</body>
</html>
